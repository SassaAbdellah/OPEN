<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">


<h:head>
	<!-- enforce UTF 8. also, header is needed for primefaces to work  -->
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</h:head>


<body>


	<ui:composition template="/templates/navbar1Layout.xhtml">



		<!-- highlight "preferences" tab -->
		<ui:param name="jrtabindex" value="#{jrtab.jorideTabindexDriver}" />



		<ui:define name="windowTitle">
                #{msgs.title}
            </ui:define>


		<ui:define name="content">


			<!-- page to display a new drive offer          -->
			<!-- i.e: the newdriverride bean                -->
			<!-- this is meant to be the end of workflow    -->
			<!-- for creating a new drive                   -->



			<h1>#{msgs.rideNewOffer} #{newdriverride.rideId}</h1>




			<table>
				<tr>
					<td class="formLabel">#{msgs.rideStarttime}</td>
					<td>:</td>
					<td class="formInput">#{newdriverride.rideStarttime}</td>
				</tr>
				<tr>
					<td><span class="formLabel"> #{msgs.rideComment} </span></td>
					<td>:</td>
					<td><span class="formInput">
							#{newdriverride.rideComment} </span></td>
				</tr>

				<tr>
					<td class="formLabel">#{msgs.rideStartptAddress}</td>
					<td>:</td>
					<td class="formInput">#{newdriverride.startptAddress}</td>
				</tr>



				<tr>

					<td colspan="1" class="formLabel"><h:form>
							<p:commandButton id="editRouting" icon="ui-icon-plus"
								action="driver.editRouting">
								<f:param name="#{crud.paramNameCrudId}"
									value="#{newdriverride.rideId}" />
								<f:param name="#{webflow.getParamBack()}" value="driver" />
							</p:commandButton>

							<p:tooltip value="#{msgs.waypointAddWaypoints}" for="editRouting" />
						</h:form></td>


					<td colspan="2" class="formLabel"><h:form>
							<h:commandLink action="driver.editRouting"
								value="#{msgs.waypointAddWaypoints}">
								<f:param name="#{crud.paramNameCrudId}"
									value="#{newdriverride.rideId}" />
								<f:param name="#{webflow.getParamBack()}" value="driver" />
							</h:commandLink>
						</h:form></td>
				</tr>





				<tr>
					<td class="formLabel">#{msgs.rideDestination}</td>
					<td>:</td>
					<td class="formInput">#{newdriverride.endptAddress}</td>
				</tr>


				<tr>
					<td class="formLabel">#{msgs.rideAcceptableDetourInKm}</td>
					<td>:</td>
					<td class="formInput">
						#{newdriverride.rideAcceptableDetourInKm}</td>
				</tr>
				<tr>
					<td class="formLabel">#{msgs.rideOfferedseatsNo}</td>
					<td>:</td>
					<td class="formInput">#{newdriverride.rideOfferedseatsNo}</td>
				</tr>


			</table>




			<p>
				<!-- hide map inside accordion until user explicitely wants to se it -->
				<p:accordionPanel dynamic="false" activeIndex="-1">

					<p:tab title="#{msgs.geocodeShowInMapLabel}">


						<!-- include standard jquery  -->
						<h:outputScript library="js" name="jquery-1.4.1.js" />

						<!-- we may deliver a local OpenLayers version 2.12              -->
						<!-- alternatively, it can be included from OpenLayers.org   -->


						<!-- h:outputScript library="js" name="OpenLayers.js" /      -->
						<script src="#{HTTPUser.openLayersURL}"></script>



						<!-- h:outputScript library="js" name="OpenLayers.js" /      -->

						<!-- include functions for displaying the routing -->
						<h:outputScript library="js" name="jorideRouting.js" />


						<!-- **************************************************************************** -->
						<!-- div to show the map  -->

						<!-- **************************************************************************** -->

						<div id="mapdiv" style="width: 300px; height: 300px;"></div>


						<script>

                    myRoutePoints =#{newdriverride.routePointsAsJSON};
                    myStartPoint =#{newdriverride.routePoints.startPointAsJSON};
                    myEndPoint =#{newdriverride.routePoints.endPointAsJSON};
                    myPickupPoints =#{newdriverride.routePoints.pickupRiderPointsAsJSON};
                    myDropPoints =#{newdriverride.routePoints.dropRiderPointsAsJSON};
                    myWayPoints =#{newdriverride.routePoints.wayPointsAsJSON};

                    createMap("mapdiv", myStartPoint, myEndPoint, myRoutePoints, myPickupPoints, myDropPoints, myWayPoints);

                </script>
					</p:tab>
				</p:accordionPanel>
			</p>

			<p>
				<span class="formLabel"> <h:form>
						<h:commandLink action="driver.editRouting"
							value="#{msgs.waypointAddWaypoints}">
							<f:param name="#{crud.paramNameCrudId}"
								value="#{newdriverride.rideId}" />
							<f:param name="#{webflow.getParamBack()}" value="driver" />
						</h:commandLink>
					</h:form>
				</span>
			</p>
                    #{webflow.smartUpdate()}  
                       <h:form>
				<table>
					<tr>
						<td><p:commandButton id="backlink"
								icon="ui-icon-triangle-1-w" action="#{webflow.getFinish()}"
								ajax="false" /> <p:tooltip for="backlink"
								value="#{msgs.finish}" /></td>
						<td><h:commandLink value="#{msgs.finish}"
								action="#{webflow.getFinish()}" /></td>
					</tr>
				</table>
			</h:form>
		</ui:define>
	</ui:composition>
</body>
</html>
